<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Productividad & Linux: Ranger</title>
  <meta name="author" content="joe di castro" />
  <meta name="keywords" content="productividad, linux, python, ncurses">
  <link rel="author" href="./humans.txt" />
  <link href='http://fonts.googleapis.com/css?family=Vollkorn:400' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="./theme/css/main.css" type="text/css" />
  <link href="./atom.xml" type="application/atom+xml" rel="alternate" title="joe di castro ATOM Feed" />
  <link href="./rss.xml" type="application/atom+xml" rel="alternate" title="joe di castro RSS Feed" />
  
  <!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>
<body id="index" class="home">

  <header id="banner" class="body">
    <h1><a href="."><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAxBAMAAADKNk2HAAAAAXNSR0IArs4c6QAAABhQTFRFvI0Ww5kxzaxW2Lp049Ki7ePG8+zX/f/8R8l4ugAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfbDAsTFi548ol9AAADmElEQVRIx62XTXOjOBCGJeHMuWWwueLZyXAV8aS4hpnscg07yXJdnCpz5kv6+9stk4CzMJusocoOBvTQ3Xr7lcLMcLQ3ch2b/3+w17MuAi6BxwuwWuC3pXmGzeWsBlz7t+AXs9qXeOo5ls7fywq8l/jYzBgVvpNV8PKF9Xp2fnRyFpHkY1YHry+dy7GanZOWn8WViWHMDCuY1UqxHbP0EJapxHSK89Mr0zFrHMvd5oMp1uJ4LAdW5gy3wH9nis1OSsmGozyx1NWQC6S/ru8Qz+ff9vv7+0f51/H49PT0ex9XsPqv0g/1/Vfy3rm+Mv7tW/8zW02OmI72bfLM9iITvyxXI8ykgh9R2m91396WL205GUDi11PxFsJkvtET/jVfLi3TyW6ErZF5K2dYaiSjcqzf7ly596d2y2vHJM4Mixqgdb8j5k/o39fdhMFrEXXEU7rHqOK7rVG+PlX4cP3lDYsauwPGfBNxcHqP5HuZP/dWEAjkHrhHZS1YiuZR8TIhp2IsPWdljv6Ocxr4GY+jlLJswcMsNOT9fdRyC1+1SyYkSVyZG6EGgHuy7M5Y4GJXQAh7RqUuPmEBPcT51ar3tjzz6FKNjXLncfLHADCLgvEDb8SYhZG6as1rrlY6xdnLbdKKlyjIh9Ba6y6/Q7PEsjaidjDFRnyWpWZylXkQj1hY2OtWVkJxJuUn84B9o3xTM6cVtiEbYd/n0/qiIa62GK6K8etvEWyAbcbr444e21YM5COsS1I0hqYxh8K3bk8fDbzscOqUYwJfhY2DNM3CgHN3NI8d4GMmSDvmIic3EJM3mWQty4B0hGB8KmJXOMd5wX56cCtzFWPAD9xU7HqkLx2sUXX4fIEcnHjridXqwBOvFba1qOAZV2HGeM18teMF2wtTbRvCu2OtRqLE0DueUF05tZptKQiVXzvWwytUFmzVDU8YqgLAU0LhnLgQeTuej1gZz+1qhkLBUVfPJxNv5AZLRhqzThXhieJhxTysiMzlD4cGbhrWb0JOrEbGJqMRbXoKp/e+I3YUfVsPYfSeLrWXqEFLRQiM6LEc9yPtAIbFqJXXU3bx8483F75Mrdu0bFcXbEpGLLtsq+0iLFrTWpkuwbJhFcIswbKYmTX2oyzC1DNbpQ+yLEZtzBKsxFum8sSiyo93JxewrE9BuAiLvHwBzVsW2vAigiBWEC4VlmEQ64XCQtYmWigszJFd8q/ZOesgvy6EMv8ALXTFAI7iFV4AAAAASUVORK5CYII=" alt="Sobre mí" title="Sobre mí" width="150" height="49" /> </a></h1>
      <nav>
      	<ul>
         
         <li class="active"><a href="./category/blog.html">blog</a></li>
         <li><a href="./archives.html">archivo</a></li>
         <li><a href="./tags.html">etiquetas</a></li>
         
         <li><a href="./pages/code.html">code</a></li><li><a href="./pages/markdown.html">markdown</a></li>
         
         <li><a href="./rss.xml">rss</a></li>
       </ul>
     </nav>
  </header><!-- /#banner -->        
<section id="content" class="body">    
<article>
  <header> 
  	<h1 class="entry-title">
      <a href="productividad-linux-ranger.html" rel="bookmark" title="Permalink a Productividad & Linux: Ranger">Productividad & Linux: Ranger</a>
  	</h1>
  	
  </header>
  <div class="entry-content">
    <abbr class="published" title="2012-10-18T21:50:00">
      Públicado el jue 18 octubre 2012
    </abbr>
    <p>Algunos pensarán, de acuerdo, podemos entender que prefieras un <a href="http://joedicastro.com/productividad-en-el-escritorio-linux-tiling.html">gestor de
ventanas de mosaico</a>, o que emplees aplicaciones como <a href="http://joedicastro.com/productividad-linux-pentadactyl.html">Pentadactyl</a>,
<a href="http://joedicastro.com/productividad-linux-newsbeuter.html">Newsbeuter</a>, <a href="http://joedicastro.com/productividad-linux-zathura.html">Zathura</a> o <a href="http://joedicastro.com/productividad-linux-turses.html">Turses</a>, pero <strong>Ranger</strong>... ya es
demasiado. ¿A quien en su sano juicio se le ocurriría utilizar semejante
engendro? A mí, y no solo lo utilizo a diario, si no que además opino que es
quizás la mejor aplicación que he descubierto en el último año y medio. Y esto
último es mucho decir para alguien, que como yo, está continuamente buscando
formas de mejorar su modo de trabajo.</p>
<p><a href="http://ranger.nongnu.org/">Ranger</a> es un administrador de archivos en modo texto. Pero no es un
administrador de archivos en modo texto clásico a dos columnas, como el norton
commander y similares. No, Ranger es una pequeña joya con un planteamiento
distinto y tan potente, que puede conseguir que olvides que no podías vivir sin
un gestor de archivos gráfico como <a href="https://es.wikipedia.org/wiki/Nautilus_(software)">Nautilus</a>, <a href="https://es.wikipedia.org/wiki/Konqueror">Konqueror</a>,
<a href="https://es.wikipedia.org/wiki/Dolphin_(administrador_de_archivos)">Dolphin</a> o <a href="https://es.wikipedia.org/wiki/Thunar">Thunar</a>.</p>
<h2 id="ranger">Ranger</h2>
<p>Tengo que estar enormemente agradecido a su autor, <a href="https://github.com/hut">Roman Zimbelmann</a> no
solo por su trabajo, si no por mostrarme que incluso en modo texto, se puede
revolucionar el mundo de la usabilidad. Evidentemente, en una aplicación que
basa su control en el teclado (tiene un soporte muy básico del ratón), es
requisito imprescindible invertir algún tiempo en aprender a utilizarlo, ya que
no es tan intuitivo como una aplicación gráfica. A menos que seas un usuario
típico de <a href="https://es.wikipedia.org/wiki/Vim">Vim</a>, entonces te encontrarás como en casa. Una vez que dominas
esta aplicación, el moverse entre los directorios y el realizar operaciones se
hace a velocidad de vértigo y con control absoluto (siempre que no seas un
manazas con el teclado).</p>
<p><strong>Ranger</strong> está desarrollado en <strong>Python</strong> y emplea una interfaz ncurses igual que
<a href="http://joedicastro.com/productividad-linux-turses.html">Turses</a>. Al contrario de lo que algunos puedan pensar, el estar
desarrollado en Python no lo convierte ni en pesado ni en lento, si no que se
mueve a velocidad endiablada y consume una cantidad de memoria ridícula
comparada con cualquier gestor de archivos gráfico.</p>
<p style="text-align:center;"><img src="static/pictures/ranger.png" width="700"
height="437" alt="Ranger" /></p>

<p>Aquí puede verse una imagen típica de ranger, visualizando el contenido de un
directorio y previsualizando el contenido de un fichero, en este caso un fichero
de código python.</p>
<h3 id="caracter+sticas">Características</h3>
<p>¿Qué se puede hacer con ranger?, bueno, quizás es mejor preguntarse que no se
puede hacer con Ranger. Prácticamente todas las funciones a las que estés
acostumbrado en un administrador de archivos gráfico se pueden realizar con
Ranger. Vamos primero a ver un resumen de sus características:</p>
<ul>
<li>Soporte de UTF-8 por defecto</li>
<li>Visualización en múltiples columnas</li>
<li>Previsualización del directorio o fichero seleccionado</li>
<li>Operaciones comunes sobre los ficheros. Crear, copiar, borrar, cambiar
  atributos (<code>chmod</code>), etc...</li>
<li>Combinaciones de teclado y consola inspiradas en Vim</li>
<li>Autodetección de tipos de fichero y apertura de los mismos con el programa
  adecuado</li>
<li>Permite establecer etiquetas y marcadores sobre archivos y directorios</li>
<li>Empleo de pestañas. Nos permite navegar por varios directorios simultáneamente
  sin necesidad de abrir otra instancia del programa. Además se pueden realizar
  operaciones entre ellas</li>
<li>Muestra una barra de progreso para las operaciones que lo necesitan</li>
</ul>
<p>Conviene dejar claro que no es un programa para <em>impacientes</em>, hacerse con él y
sus innumerables opciones requiere tiempo. Hay que leerse la ayuda del programa
y practicar con él. A su vez, si queremos personalizar las opciones o ampliarlo,
debemos comprender como funcionan sus archivos de configuración, mejor aún si
tenemos conocimientos de Python. La documentación de su web, así como la de sus
páginas <em>man</em> está un poco desactualizada, por lo que sacarle todo su jugo
requiere algo de paciencia.</p>
<h3 id="ejemplos">Ejemplos</h3>
<p>Voy a intentar dar algo de visibilidad a algunas de las capacidades que nos
ofrece ranger empleando una par de ejemplos que lo ilustren.</p>
<p>En el siguiente ejemplo vemos la previsualización que hace ranger en función del
tipo de fichero que se trate.</p>
<div style="text-align:center">
<iframe src="http://player.vimeo.com/video/62061254?title=0&amp;byline=0&amp;portrait=0" 
width="700" height="438">
</iframe>
<p>Previsualización de archivos en ranger con varios tipos de archivo.
Recomiendo ver en alta resolución y a pantalla completa.</p>
</div>

<p>La previsualización de imágenes en ASCII puede parecer una tontería, pero
resulta muy útil a la hora de diferenciar entre distintas imágenes con nombre
muy parecido. El fichero en HTML está renderizado en vez de mostrarnos el texto
plano, algo más amigable. También se agradece mucho el que los ficheros de
código se vean con resaltado de sintaxis.</p>
<blockquote>
<p>Conviene aclarar que para realizar esta previsualización es necesario tener
instalado una serie de pequeñas aplicaciones que se detallan en el sitio de
ranger como dependencias.</p>
</blockquote>
<p>Aquí vemos como se abren automáticamente los programas adecuados en función del
tipo de archivo (se puede configurar que aplicaciones emplear y cuales usar en
cada momento)</p>
<div style="text-align:center">
<iframe src="http://player.vimeo.com/video/62634892?title=0&amp;byline=0&amp;portrait=0" 
width="700" height="438">
</iframe>
<p>Ejecución automática de aplicaciones en función del tipo de archivo.
Recomiendo ver en alta resolución y a pantalla completa.</p>
</div>

<p>En el caso del fichero Torrent, al que no tengo asociada ninguna aplicación en
ranger, me abre un comando en el que puedo especificar directamente la
aplicación que deseo emplear para gestionarlo. En este caso, ninguna. En el
archivo comprimido solo me muestra el contenido del mismo, podría asociarle
alguna aplicación, pero ya tengo comandos para manejarlos dentro del propio
ranger, algo que veremos a continuación.</p>
<h2 id="mi_configuraci+n">Mi configuración</h2>
<p>No he personalizado mucho mi configuración de momento, pero quien quiera echarle
un vistazo puede hacerlo en mi repositorio dotfiles en <a href="http://github.com/joedicastro/dotfiles">GitHub</a></p>
<h3 id="archivos_de_configuraci+n">Archivos de configuración</h3>
<p>Para configurar ranger necesitamos editar ciertos archivos, que crearemos por
primera vez con el siguiente comando:</p>
<div class="codehilite"><pre><span class="nv">$ </span>ranger --copy-config<span class="o">=</span>all
</pre></div>


<p>qué nos creara los siguientes archivos por defecto en la carpeta
<code>~/.config/ranger/</code>:</p>
<ul>
<li><code>commands.py</code> <em>(python)</em>, en este archivo se configuran los comandos a emplear
  en la línea de comandos de ranger</li>
<li><code>options.py</code> <em>(python)</em>, el fichero de opciones principal de ranger</li>
<li><code>rc.conf</code> <em>(texto)</em>, aquí configuramos los atajos de teclado de ranger</li>
<li><code>rifle.conf</code> <em>(texto)</em>, para establecer los programas que ejecutaran o abrirán
  un tipo de archivo en orden de preferencia</li>
<li><code>scope.sh</code> <em>(bash)</em>, los programas empleados para previsualizar un determinado
  tipo de archivo</li>
</ul>
<p>Adicionalmente, con el uso se añadirán tres ficheros más: <code>bookmarks</code>, <code>history</code>
y <code>tagged</code> que guardarán los marcadores, la historia de comandos y las etiquetas
respectivamente.</p>
<h3 id="gestionar_la_papelera">Gestionar la papelera</h3>
<p>Por defecto ranger no contempla la gestión de la papelera de Linux que
implementan escritorios como Gnome. Aunque no empleo ningún entorno
de escritorio ni gestores de archivos gráficos, si me interesa gestionar la
papelera, pues cada vez más aplicaciones la emplean para eliminar los archivos.
De hecho en <em>bash</em> y <em>zsh</em> tengo un alias para <code>rm</code> que mueve los archivos a la
papelera en vez de eliminarlos.</p>
<div class="codehilite"><pre><span class="nb">alias </span><span class="nv">rm</span><span class="o">=</span><span class="s1">&#39;mv --target-directory ~/.local/share/Trash/files&#39;</span>
</pre></div>


<p>Para gestionar la papelera desde ranger, añado dos atajos de teclado y un
comando editando varios archivos de configuración de la siguiente manera:</p>
<p><strong>Mandar archivos a la papelera</strong></p>
<p>Para mandar a la papelera lo que tengamos seleccionado actualmente, en lugar de
eliminarlo directamente, añadimos esta línea al fichero <code>rc.conf</code></p>
<div class="codehilite"><pre><span class="c"># move to trash</span>
<span class="nb">map</span> <span class="n">DD</span> <span class="n">shell</span> <span class="n">mv</span> <span class="o">-</span><span class="n">t</span> <span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">Trash</span><span class="o">/</span><span class="n">files</span> <span class="o">%</span><span class="n">s</span>
</pre></div>


<p>de este modo, cada vez que pulsemos <strong><code>DD</code></strong> el contenido seleccionado es movido
al directorio donde tenemos nuestra papelera.</p>
<p><strong>Movernos a la papelera</strong></p>
<p>Del mismo modo que ranger provee por defecto de atajos de teclado para movernos
al directorio <code>home</code>, al directorio raiz, etc, he añadido un atajo de teclado
siguiendo el mismo criterio para acceder a nuestra papelera. Añadimos lo
siguiente al fichero <code>rc.conf</code></p>
<div class="codehilite"><pre><span class="c"># go to trash</span>
<span class="nb">map</span> <span class="n">gp</span> <span class="n">cd</span> <span class="o">~/.</span><span class="n">local</span><span class="o">/</span><span class="n">share</span><span class="o">/</span><span class="n">Trash</span><span class="o">/</span><span class="n">files</span>
</pre></div>


<p>así, pulsando <strong><code>gp</code></strong> vamos directamente a la papelera, estemos donde estemos.</p>
<p><strong>Vaciar la papelera</strong></p>
<p>Para vaciar la papelera opto por emplear un comando, para ello tenemos que
editar otro fichero, <code>commands.py</code>, y añadir lo siguiente</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">empty</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    :empty</span>

<span class="sd">    Empties the trash directory ~/.local/share/Trash/files</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fm</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s">&quot;rm -rf ~/.local/share/Trash/files/{*,.[^.]*}&quot;</span><span class="p">)</span>
</pre></div>


<p>por lo que vaciar la papelera se convierte en algo tan simple como teclear
<strong><code>:empty</code></strong> o para los más cómodos <strong><code>:em↹</code></strong></p>
<h3 id="desmontar_una_unidad_con_udiskie">Desmontar una unidad con udiskie</h3>
<p>Dada mi "particular" configuración, ya que no empleo ningún escritorio, empleo
la herramienta <a href="https://bitbucket.org/byronclark/udiskie">udiskie</a> para automontar unidades de almacenamiento
externas, como unidades USB o tarjetas de memoria. El montado se hace de forma
automática y solo el desmontado ha de hacerse de forma manual. Ya que no quiero
teclear el comando cada vez que desee desmontar una unidad, lo que hago es
hacerlo desde ranger. En el fichero <code>rc.conf</code> mapeamos este atajo</p>
<div class="codehilite"><pre><span class="c"># umount a drive with udiskie</span>
<span class="nb">map</span> <span class="n">un</span> <span class="n">shell</span> <span class="o">-</span><span class="n">d</span> <span class="n">udiskie</span><span class="o">-</span><span class="n">umount</span> <span class="o">%</span><span class="n">d</span><span class="o">/%</span><span class="n">f</span>
</pre></div>


<p>así para desmontar una unidad inicio ranger (en mi caso <strong><code>Win + F1</code></strong>), me
dirijo a las unidades externas montadas, <strong><code>gm</code></strong>, selecciono la unidad deseada
y la desmonto, <strong><code>un</code></strong>. Un proceso que me lleva apenas dos segundos, sin
abandonar las manos del teclado, compárese con hacerlo con un ratón y un entorno
gráfico.</p>
<h3 id="expulsar_un_cddvd">Expulsar un CD/DVD</h3>
<p>Del mismo modo, en lugar de abrir un terminal y escribir el comando <code>eject</code>, en
determinadas circunstancias, por ejemplo al acabar de examinar el contenido de
un disco, prefiero hacerlo directamente desde ranger. Para ello en el fichero
<code>rc.conf</code> creamos este atajo de teclado</p>
<div class="codehilite"><pre><span class="c"># eject a CD-ROM/DVD</span>
<span class="nb">map</span> <span class="n">ej</span> <span class="n">shell</span> <span class="o">-</span><span class="n">d</span> <span class="n">eject</span>
</pre></div>


<h3 id="trabajar_con_archivos_comprimidos">Trabajar con archivos comprimidos</h3>
<p>Estos comandos los he sacado de el <a href="https://wiki.archlinux.org/index.php/Ranger">Wiki de Arch Linux</a> y los he adaptado
a la versión de ranger que estoy empleando en este momento, la 1.5.5</p>
<p><strong>Extraer los ficheros de un archivo comprimido</strong></p>
<p>Con el comando <strong><code>:extracthere</code></strong> extraemos el contenido de un archivo/s
comprimido que previamente habremos seleccionado para copia (es decir empleando
el atajo <strong><code>yy</code></strong>). El contenido se extrae en el directorio en el que nos
encontremos actualmente. Es muy comodo para extraer múltiples archivos
comprimidos a la vez, si quisieramos descomprimir solo un archivo y en el mismo
directorio en el que este se encuentra, podríamos emplear el atajo <strong><code>1l</code></strong></p>
<p>Para añadir el comando a ranger, tenemos que insertar esta clase en el fichero
<code>commands.py</code></p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">extracthere</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Extract copied files to current directory &quot;&quot;&quot;</span>
        <span class="n">copied_files</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fm</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">copy</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">copied_files</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
            <span class="n">cwd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fm</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">get_directory</span><span class="p">(</span><span class="n">original_path</span><span class="p">)</span>
            <span class="n">cwd</span><span class="o">.</span><span class="n">load_content</span><span class="p">()</span>

        <span class="n">one_file</span> <span class="o">=</span> <span class="n">copied_files</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">cwd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fm</span><span class="o">.</span><span class="n">thisdir</span>
        <span class="n">original_path</span> <span class="o">=</span> <span class="n">cwd</span><span class="o">.</span><span class="n">path</span>
        <span class="n">au_flags</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;-X&#39;</span><span class="p">,</span> <span class="n">cwd</span><span class="o">.</span><span class="n">path</span><span class="p">]</span>
        <span class="n">au_flags</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">au_flags</span> <span class="o">+=</span> <span class="p">[</span><span class="s">&#39;-e&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fm</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">copy</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fm</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">cut</span> <span class="o">=</span> <span class="bp">False</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">copied_files</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">descr</span> <span class="o">=</span> <span class="s">&quot;extracting: &quot;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">one_file</span><span class="o">.</span><span class="n">path</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">descr</span> <span class="o">=</span> <span class="s">&quot;extracting files from: &quot;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">one_file</span><span class="o">.</span><span class="n">dirname</span><span class="p">)</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">CommandLoader</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;aunpack&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">au_flags</span> \
                <span class="o">+</span> <span class="p">[</span><span class="n">f</span><span class="o">.</span><span class="n">path</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">copied_files</span><span class="p">],</span> <span class="n">descr</span><span class="o">=</span><span class="n">descr</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">signal_bind</span><span class="p">(</span><span class="s">&#39;after&#39;</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fm</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
</pre></div>


<p><strong>Crear un archivo comprimido</strong></p>
<p>Este comando te permite seleccionar uno o varios ficheros y crear un archivo
comprimido al llamar al comando <strong><code>:compress</code></strong>. Este comando te permite (a
través del autocompletado) darle un nombre automático a partir del directorio o
uno personalizado. Te permite además seleccionar el tipo de compresión en
función de la extension empleada.</p>
<p>En el fichero <code>commands.py</code> añadimos el siguiente código.</p>
<div class="codehilite"><pre><span class="k">class</span> <span class="nc">compress</span><span class="p">(</span><span class="n">Command</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">execute</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Compress marked files to current directory &quot;&quot;&quot;</span>
        <span class="n">cwd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fm</span><span class="o">.</span><span class="n">thisdir</span>
        <span class="n">marked_files</span> <span class="o">=</span> <span class="n">cwd</span><span class="o">.</span><span class="n">get_selection</span><span class="p">()</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">marked_files</span><span class="p">:</span>
            <span class="k">return</span>

        <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="n">_</span><span class="p">):</span>
            <span class="n">cwd</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fm</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">get_directory</span><span class="p">(</span><span class="n">original_path</span><span class="p">)</span>
            <span class="n">cwd</span><span class="o">.</span><span class="n">load_content</span><span class="p">()</span>

        <span class="n">original_path</span> <span class="o">=</span> <span class="n">cwd</span><span class="o">.</span><span class="n">path</span>
        <span class="n">parts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">line</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>
        <span class="n">au_flags</span> <span class="o">=</span> <span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="n">descr</span> <span class="o">=</span> <span class="s">&quot;compressing files in: &quot;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">parts</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">CommandLoader</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="p">[</span><span class="s">&#39;apack&#39;</span><span class="p">]</span> <span class="o">+</span> <span class="n">au_flags</span> <span class="o">+</span> \
                <span class="p">[</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">relpath</span><span class="p">(</span><span class="n">f</span><span class="o">.</span><span class="n">path</span><span class="p">,</span> <span class="n">cwd</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">marked_files</span><span class="p">],</span> <span class="n">descr</span><span class="o">=</span><span class="n">descr</span><span class="p">)</span>
        <span class="n">obj</span><span class="o">.</span><span class="n">signal_bind</span><span class="p">(</span><span class="s">&#39;after&#39;</span><span class="p">,</span> <span class="n">refresh</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">fm</span><span class="o">.</span><span class="n">loader</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tab</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot; Complete with current folder name &quot;&quot;&quot;</span>
        <span class="n">extension</span> <span class="o">=</span> <span class="p">[</span><span class="s">&#39;.zip&#39;</span><span class="p">,</span> <span class="s">&#39;.tar.gz&#39;</span><span class="p">,</span> <span class="s">&#39;.rar&#39;</span><span class="p">,</span> <span class="s">&#39;.7z&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">[</span><span class="s">&#39;compress &#39;</span> <span class="o">+</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fm</span><span class="o">.</span><span class="n">thisdir</span><span class="o">.</span><span class="n">path</span><span class="p">)</span> <span class="o">+</span> <span class="n">ext</span> <span class="k">for</span> <span class="n">ext</span> <span class="ow">in</span> <span class="n">extension</span><span class="p">]</span>
</pre></div>
  </div><!-- /.entry-content -->
  <p class="tagged">Etiquetado como: <a href="./tag/productividad.html">productividad</a>, <a href="./tag/linux.html">linux</a>, <a href="./tag/python.html">python</a>, <a href="./tag/ncurses.html">ncurses</a>.</p>

  
  <div class="comments">
    <h3>Comentarios !</h3>
    <div id="disqus_thread"></div>
      <script type="text/javascript">
         var disqus_identifier = "productividad-linux-ranger.html";
         (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = 'http://joedicastro.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
    </div>
  
</article>
</section>
<footer id="contentinfo" class="body">
    <address id="about" class="vcard body">
      © 2010-2015 joe di castro - <a
          href="mailto:joe@joedicastro.com">correo</a>|<a
          href="http://twitter.com/joe_di_castro">twitter</a>|<a
          href="https://github.com/joedicastro">github</a> <span id="license">El contenido está bajo <a href="http://creativecommons.org/licenses/by-sa/3.0/es">licencia Creative Commons</a></span>
    </address><!-- /#about -->
  </footer><!-- /#contentinfo -->


<script type="text/javascript">
    var disqus_shortname = 'joedicastro';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</body>
</html>