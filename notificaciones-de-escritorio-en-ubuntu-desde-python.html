<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="utf-8" />
  <title>Notificaciones de escritorio en Ubuntu desde Python</title>
  <meta name="author" content="joe di castro" />
  <meta name="keywords" content="linux, ubuntu, python">
  <link rel="author" href="./humans.txt" />
  <link href='http://fonts.googleapis.com/css?family=Vollkorn:400' rel='stylesheet' type='text/css'>
  <link rel="stylesheet" href="./theme/css/main.css" type="text/css" />
  <link href="./atom.xml" type="application/atom+xml" rel="alternate" title="joe di castro ATOM Feed" />
  <link href="./rss.xml" type="application/atom+xml" rel="alternate" title="joe di castro RSS Feed" />
  
  <!--[if IE]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
</head>
<body id="index" class="home">

  <header id="banner" class="body">
    <h1><a href="."><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJYAAAAxBAMAAADKNk2HAAAAAXNSR0IArs4c6QAAABhQTFRFvI0Ww5kxzaxW2Lp049Ki7ePG8+zX/f/8R8l4ugAAAAFiS0dEAIgFHUgAAAAJcEhZcwAADdcAAA3XAUIom3gAAAAHdElNRQfbDAsTFi548ol9AAADmElEQVRIx62XTXOjOBCGJeHMuWWwueLZyXAV8aS4hpnscg07yXJdnCpz5kv6+9stk4CzMJusocoOBvTQ3Xr7lcLMcLQ3ch2b/3+w17MuAi6BxwuwWuC3pXmGzeWsBlz7t+AXs9qXeOo5ls7fywq8l/jYzBgVvpNV8PKF9Xp2fnRyFpHkY1YHry+dy7GanZOWn8WViWHMDCuY1UqxHbP0EJapxHSK89Mr0zFrHMvd5oMp1uJ4LAdW5gy3wH9nis1OSsmGozyx1NWQC6S/ru8Qz+ff9vv7+0f51/H49PT0ex9XsPqv0g/1/Vfy3rm+Mv7tW/8zW02OmI72bfLM9iITvyxXI8ykgh9R2m91396WL205GUDi11PxFsJkvtET/jVfLi3TyW6ErZF5K2dYaiSjcqzf7ly596d2y2vHJM4Mixqgdb8j5k/o39fdhMFrEXXEU7rHqOK7rVG+PlX4cP3lDYsauwPGfBNxcHqP5HuZP/dWEAjkHrhHZS1YiuZR8TIhp2IsPWdljv6Ocxr4GY+jlLJswcMsNOT9fdRyC1+1SyYkSVyZG6EGgHuy7M5Y4GJXQAh7RqUuPmEBPcT51ar3tjzz6FKNjXLncfLHADCLgvEDb8SYhZG6as1rrlY6xdnLbdKKlyjIh9Ba6y6/Q7PEsjaidjDFRnyWpWZylXkQj1hY2OtWVkJxJuUn84B9o3xTM6cVtiEbYd/n0/qiIa62GK6K8etvEWyAbcbr444e21YM5COsS1I0hqYxh8K3bk8fDbzscOqUYwJfhY2DNM3CgHN3NI8d4GMmSDvmIic3EJM3mWQty4B0hGB8KmJXOMd5wX56cCtzFWPAD9xU7HqkLx2sUXX4fIEcnHjridXqwBOvFba1qOAZV2HGeM18teMF2wtTbRvCu2OtRqLE0DueUF05tZptKQiVXzvWwytUFmzVDU8YqgLAU0LhnLgQeTuej1gZz+1qhkLBUVfPJxNv5AZLRhqzThXhieJhxTysiMzlD4cGbhrWb0JOrEbGJqMRbXoKp/e+I3YUfVsPYfSeLrWXqEFLRQiM6LEc9yPtAIbFqJXXU3bx8483F75Mrdu0bFcXbEpGLLtsq+0iLFrTWpkuwbJhFcIswbKYmTX2oyzC1DNbpQ+yLEZtzBKsxFum8sSiyo93JxewrE9BuAiLvHwBzVsW2vAigiBWEC4VlmEQ64XCQtYmWigszJFd8q/ZOesgvy6EMv8ALXTFAI7iFV4AAAAASUVORK5CYII=" alt="Sobre mí" title="Sobre mí" width="150" height="49" /> </a></h1>
      <nav>
      	<ul>
         
         <li class="active"><a href="./category/blog.html">blog</a></li>
         <li><a href="./archives.html">archivo</a></li>
         <li><a href="./tags.html">etiquetas</a></li>
         
         <li><a href="./pages/code.html">code</a></li><li><a href="./pages/markdown.html">markdown</a></li>
         
         <li><a href="./rss.xml">rss</a></li>
       </ul>
     </nav>
  </header><!-- /#banner -->        
<section id="content" class="body">    
<article>
  <header> 
  	<h1 class="entry-title">
      <a href="notificaciones-de-escritorio-en-ubuntu-desde-python.html" rel="bookmark" title="Permalink a Notificaciones de escritorio en Ubuntu desde Python">Notificaciones de escritorio en Ubuntu desde Python</a>
  	</h1>
  	
  </header>
  <div class="entry-content">
    <abbr class="published" title="2011-06-12T23:05:00">
      Públicado el dom 12 junio 2011
    </abbr>
    <p>En <strong>Ubuntu</strong><sup id="fnref:1"><a href="#fn:1" >1</a></sup> las notificaciones de escritorio son esos <strong>cuadros
emergentes</strong> que nos proporcionan información sobre algún evento que se está
produciendo en nuestro equipo (llegada de un email, canción que se está
reproduciendo, cambio de volumen, estado de batería, etc). Sustituyen a las
ventanas de dialogo que normalmente requieren la intervención del usuario para
cerrarlas y son más molestas. Además frente a las ventanas de dialogo tienen la
gran ventaja de que son gestionadas a través de una cola. Es decir, que si hay
varias notificaciones para mostrar, no se muestran todas a la vez llenándote
todo el escritorio de pequeñas ventanas, se van mostrando una después de otra.
La notificaciones aparecen en una esquina del escritorio y se desvanecen por si
solas al cabo de unos segundos. Son muy útiles porque llaman nuestra atención y
nos informan sin interrumpir nuestro trabajo.</p>
<p style="text-align:center;"><img src="static/pictures/notify_example.png" width="366"
 height="147" alt="notify_example.png" title="Ejemplo de notificación"/></p>

<p>En Ubuntu esta operación la realiza el paquete <a href="https://launchpad.net/notify-osd">Notify OSD</a> que se basa en
las especificaciones del proyecto <a href="http://www.galago-project.org/about.php">Galago</a> (<a href="http://www.galago-project.org/specs/notification/0.9/">freedesktop.org Desktop
Notifications Specification</a>). Este emplea el demonio <em>notify-osd</em> para
enviar las notificaciones a través de <a href="http://www.freedesktop.org/wiki/Software/dbus">D-Bus</a>. Sin embargo muchos paquetes
aún emplean la librería <strong>libnotify</strong> del proyecto Galago para enviar sus
notificaciones. Además el proyecto Galago tiene un <a href="http://es.wikipedia.org/wiki/Binding">binding</a> para <strong>Python</strong>
de está librería, que es lo que emplearé en este artículo. En Ubuntu, es el
paquete <a href="http://packages.ubuntu.com/es/natty/i386/python-notify">python-notify</a> y se importa desde Python como <code>pynotify</code>. También
es posible emplear el paquete <a href="http://packages.ubuntu.com/natty/libnotify-bin">libnotify-bin</a> que nos proporciona el comando
<code>notify-send</code> que nos permite enviar notificaciones directamente desde la línea
de comandos, algo que puede ser muy útil para scripts en <a href="http://es.wikipedia.org/wiki/Bash"><em>bash</em></a>.</p>
<p>Ejemplo de utilización de <code>notify-send</code>:</p>
<div class="codehilite"><pre><span class="nv">$ </span>notify-send <span class="s2">&quot;Notificación&quot;</span> <span class="s2">&quot;Esto es un ejemplo de notificación&quot;</span>
</pre></div>


<p>que nos mostraría una notificación como esta:</p>
<p style="text-align:center;"><img src="static/pictures/notify_send.png" width="341"
height="84" alt="notify_send.png" /></p>

<h2 id="notificaciones_desde_python">Notificaciones desde Python</h2>
<p>Empleando <code>pynotify</code> podemos emplear estas notificaciones en nuestros programas
y scripts Python y se visualizaran igual que las propias del sistema. El
problema que tiene este modulo es que no tiene documentación <abbr title="As Far As I Know (en español &quot;Hasta donde yo sé&quot; o &quot;Que yo sepa&quot;)">AFAIK</abbr>, por lo que
tenemos que guiarnos por algunos ejemplos (los del <a href="http://www.galago-project.org/downloads.php">propio paquete</a>, por
ejemplo) o experimentar con él ayudándonos de las herramientas de introspección
de Python (<code>help()</code>, <code>dir()</code>, <a href="http://docs.python.org/library/inspect.html">inspect</a>).</p>
<p>Para poder emplearlo en mis programas he creado una función que hace uso de las
opciones principales de las notificaciones:</p>
<div class="codehilite"><pre><span class="kn">import</span> <span class="nn">pynotify</span>
<span class="kn">import</span> <span class="nn">gtk</span>

<span class="k">def</span> <span class="nf">notify</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">icon</span><span class="o">=</span><span class="bp">None</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Send notification icon messages through libnotify.</span>

<span class="sd">    Parameters:</span>

<span class="sd">    (str) title -- The notification title</span>
<span class="sd">    (str) msg -- The message to display into notification</span>
<span class="sd">    (str / uri) icon -- Type of icon (ok|info|error|warm|ask|sync) or icon file</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">pynotify</span><span class="o">.</span><span class="n">is_initted</span><span class="p">():</span>
        <span class="n">pynotify</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">title</span><span class="p">)</span>
    <span class="n">gtk_icon</span> <span class="o">=</span> <span class="p">{</span><span class="s">&#39;ok&#39;</span><span class="p">:</span><span class="n">gtk</span><span class="o">.</span><span class="n">STOCK_YES</span><span class="p">,</span> <span class="s">&#39;info&#39;</span><span class="p">:</span><span class="n">gtk</span><span class="o">.</span><span class="n">STOCK_DIALOG_INFO</span><span class="p">,</span>
                <span class="s">&#39;error&#39;</span><span class="p">:</span><span class="n">gtk</span><span class="o">.</span><span class="n">STOCK_DIALOG_ERROR</span><span class="p">,</span> <span class="s">&#39;warm&#39;</span><span class="p">:</span><span class="n">gtk</span><span class="o">.</span><span class="n">STOCK_DIALOG_WARNING</span><span class="p">,</span>
                <span class="s">&#39;ask&#39;</span><span class="p">:</span><span class="n">gtk</span><span class="o">.</span><span class="n">STOCK_DIALOG_QUESTION</span><span class="p">,</span> <span class="s">&#39;sync&#39;</span><span class="p">:</span><span class="n">gtk</span><span class="o">.</span><span class="n">STOCK_JUMP_TO</span><span class="p">}</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">note</span> <span class="o">=</span> <span class="n">pynotify</span><span class="o">.</span><span class="n">Notification</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">msg</span><span class="p">)</span>
        <span class="n">helper</span> <span class="o">=</span> <span class="n">gtk</span><span class="o">.</span><span class="n">Button</span><span class="p">()</span>
        <span class="n">gtk_icon</span> <span class="o">=</span> <span class="n">helper</span><span class="o">.</span><span class="n">render_icon</span><span class="p">(</span><span class="n">gtk_icon</span><span class="p">[</span><span class="n">icon</span><span class="p">],</span> <span class="n">gtk</span><span class="o">.</span><span class="n">ICON_SIZE_BUTTON</span><span class="p">)</span>
        <span class="n">note</span><span class="o">.</span><span class="n">set_icon_from_pixbuf</span><span class="p">(</span><span class="n">gtk_icon</span><span class="p">)</span>
    <span class="k">except</span> <span class="ne">KeyError</span><span class="p">:</span>
        <span class="n">note</span> <span class="o">=</span> <span class="n">pynotify</span><span class="o">.</span><span class="n">Notification</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">msg</span><span class="p">,</span> <span class="n">icon</span><span class="p">)</span>
    <span class="n">note</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>


<p>Básicamente llamamos a la función y le decimos que titulo le queremos poner, el
mensaje y el icono que queremos mostrar. En cuanto al icono se puede emplear
ninguno, uno personalizado indicando la ruta al fichero o un icono estándar de
GTK para las opciones más comunes. Veamos lo sencillo de su funcionamiento con
ejemplos:</p>
<div class="codehilite"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Notificación sin icono</span>
<span class="gp">... </span><span class="n">notify</span><span class="p">(</span><span class="s">&quot;Titulo&quot;</span><span class="p">,</span> <span class="s">&quot;Esta notificación no lleva icono&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>


<p style="text-align:center;"><img src="static/pictures/notify_noicon.png" width="339"
height="87" alt="notify_noicon.png" /></p>

<div class="codehilite"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Notificación con icono personalizado</span>
<span class="gp">... </span><span class="n">notify</span><span class="p">(</span><span class="s">&quot;Ubuntu&quot;</span><span class="p">,</span> <span class="s">&quot;Esta lleva el icono personalizado&quot;</span><span class="p">,</span>
<span class="go">&quot;/usr/share/icons/gnome/scalable/places/ubuntu-logo.svg&quot;)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>


<p style="text-align:center;"><img src="static/pictures/notify_ubuntu.png" width="339"
height="87" alt="notify_ubuntu.png" /></p>

<div class="codehilite"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Notificación de información (GTK)</span>
<span class="gp">... </span><span class="n">notify</span><span class="p">(</span><span class="s">&quot;Información&quot;</span><span class="p">,</span> <span class="s">&quot;Esta emplea el icono de información estándar de GTK&quot;</span><span class="p">,</span> <span class="s">&quot;info&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>


<p style="text-align:center;"><img src="static/pictures/notify_info.png" width="339"
height="87" alt="notify_info.png" /></p>

<div class="codehilite"><pre><span class="gp">&gt;&gt;&gt; </span><span class="c"># Notificación de error (GTK)</span>
<span class="gp">... </span><span class="n">notify</span><span class="p">(</span><span class="s">&quot;Error!&quot;</span><span class="p">,</span> <span class="s">&quot;Ejemplo de reporte de error (GTK)&quot;</span><span class="p">,</span> <span class="s">&quot;error&quot;</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
</pre></div>


<p style="text-align:center;"><img src="static/pictures/notify_error.png" width="338"
height="87" alt="notify_error.png" /></p>

<p>Como se puede ver el proceso es realmente sencillo y hacer esto puede aportar a
nuestros programas/scripts ese toque que le faltaba y que tanto contribuye a la
usabilidad de los mismos. Yo por ejemplo, lo empleo en scripts programados para
saber cuando se activan y cuando terminan, sobre todo cuando son procesos
largos. Un ejemplo puede verse en el código de <a href="http://joedicastro.com/sincronizar-una-carpeta-local-y-una-remota-a-traves-de-ftp-lftp-mirror.html">Sincronizar una carpeta local y
una remota a través de FTP: lftp-mirror</a></p>
<p>El fichero con este código, <code>notify.py</code> se encuentra en el repositorio <em>Python
Recipes</em> alojado en <a href="http://github.com/joedicastro/python-recipes">github</a>.</p>
<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p>Se puede emplear también en otras distribuciones Linux
&#160;<a href="#fnref:1"  title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div>
  </div><!-- /.entry-content -->
  <p class="tagged">Etiquetado como: <a href="./tag/linux.html">linux</a>, <a href="./tag/ubuntu.html">ubuntu</a>, <a href="./tag/python.html">python</a>.</p>

  
  <div class="comments">
    <h3>Comentarios !</h3>
    <div id="disqus_thread"></div>
      <script type="text/javascript">
         var disqus_identifier = "notificaciones-de-escritorio-en-ubuntu-desde-python.html";
         (function() {
         var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
         dsq.src = 'http://joedicastro.disqus.com/embed.js';
         (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
      </script>
    </div>
  
</article>
</section>
<footer id="contentinfo" class="body">
    <address id="about" class="vcard body">
      © 2010-2015 joe di castro - <a
          href="mailto:joe@joedicastro.com">correo</a>|<a
          href="http://twitter.com/joe_di_castro">twitter</a>|<a
          href="https://github.com/joedicastro">github</a> <span id="license">El contenido está bajo <a href="http://creativecommons.org/licenses/by-sa/3.0/es">licencia Creative Commons</a></span>
    </address><!-- /#about -->
  </footer><!-- /#contentinfo -->


<script type="text/javascript">
    var disqus_shortname = 'joedicastro';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>

</body>
</html>